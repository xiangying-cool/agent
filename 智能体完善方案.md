# æ™ºèƒ½ä½“å®Œå–„æ–¹æ¡ˆ ğŸš€

## ğŸ“Š ä¸€ã€è¾“å‡ºå¤šæ ·åŒ–å¢å¼º

### 1. å¤šæ ¼å¼è¾“å‡º
```python
# åœ¨ prompt_builder.py å¢åŠ è¾“å‡ºæ ¼å¼æ§åˆ¶
class OutputFormatter:
    def format_as_table(self, data):
        """è¡¨æ ¼æ ¼å¼"""
        pass
    
    def format_as_chart(self, data):
        """å›¾è¡¨æ•°æ®ï¼ˆå‰ç«¯æ¸²æŸ“ï¼‰"""
        return {
            "type": "bar",
            "data": {
                "labels": ["å†°ç®±", "æ´—è¡£æœº"],
                "values": [600, 400]
            }
        }
    
    def format_as_timeline(self, data):
        """æ—¶é—´è½´å±•ç¤ºï¼ˆæ”¿ç­–å†å²ï¼‰"""
        pass
```

### 2. å¯è§†åŒ–æŠ¥è¡¨
- **é¥¼å›¾**: è¡¥è´´å æ¯”
- **æŸ±çŠ¶å›¾**: äº§å“ä»·æ ¼å¯¹æ¯”
- **æŠ˜çº¿å›¾**: å†å²è¡¥è´´è¶‹åŠ¿
- **é›·è¾¾å›¾**: äº§å“ç»¼åˆè¯„åˆ†

### 3. è¯­éŸ³è¾“å‡º
```python
# é›†æˆTTSï¼ˆæ–‡å­—è½¬è¯­éŸ³ï¼‰
from edge_tts import Communicate

async def text_to_speech(text: str) -> bytes:
    """å°†å›ç­”è½¬ä¸ºè¯­éŸ³"""
    communicate = Communicate(text, "zh-CN-XiaoxiaoNeural")
    audio_bytes = b""
    async for chunk in communicate.stream():
        if chunk["type"] == "audio":
            audio_bytes += chunk["data"]
    return audio_bytes
```

---

## ğŸ”Œ äºŒã€æ’ä»¶ç³»ç»Ÿæ‰©å±•

### å·²åˆ›å»ºæ’ä»¶æ¡†æ¶
- âœ… `plugin_manager.py` - æ’ä»¶ç®¡ç†å™¨
- âœ… `plugins/price_comparator.py` - ä»·æ ¼æ¯”è¾ƒ
- âœ… `plugins/report_generator.py` - æŠ¥å‘Šç”Ÿæˆ

### å»ºè®®æ–°å¢æ’ä»¶

#### 1. **èˆ†æƒ…åˆ†ææ’ä»¶**
```python
# plugins/sentiment_analyzer.py
class Plugin(PluginBase):
    def execute(self, context):
        """åˆ†æç”¨æˆ·å¯¹äº§å“çš„æƒ…æ„Ÿå€¾å‘"""
        reviews = context.get("reviews", [])
        # è°ƒç”¨æƒ…æ„Ÿåˆ†æAPI
        return {
            "positive": 0.8,
            "negative": 0.1,
            "neutral": 0.1
        }
```

#### 2. **æ™ºèƒ½æé†’æ’ä»¶**
```python
# plugins/smart_reminder.py
class Plugin(PluginBase):
    def execute(self, context):
        """æ”¿ç­–åˆ°æœŸæé†’ã€è¡¥è´´ç”³è¯·æˆªæ­¢æé†’"""
        return {
            "reminders": [
                {
                    "type": "policy_expire",
                    "message": "æµå—å¸‚æ±½è½¦è¡¥è´´å°†äº2025-12-31æˆªæ­¢",
                    "urgency": "high"
                }
            ]
        }
```

#### 3. **æ›¿ä»£æ–¹æ¡ˆæ¨è**
```python
# plugins/alternative_recommender.py
class Plugin(PluginBase):
    def execute(self, context):
        """æ¨èæ€§ä»·æ¯”ç›¸è¿‘çš„æ›¿ä»£äº§å“"""
        original_product = context.get("product")
        return {
            "alternatives": [
                {"name": "æµ·å°”å†°ç®±BCD-500", "price": 2899, "similarity": 0.95}
            ]
        }
```

#### 4. **OCRè¯†åˆ«æ’ä»¶**
```python
# plugins/ocr_reader.py
class Plugin(PluginBase):
    def execute(self, context):
        """è¯†åˆ«è´­ç‰©å°ç¥¨ã€å‘ç¥¨"""
        image_path = context.get("image")
        # è°ƒç”¨OCR API
        return {
            "products": ["å†°ç®±", "æ´—è¡£æœº"],
            "total_amount": 8000
        }
```

---

## ğŸ¨ ä¸‰ã€å‰ç«¯äº¤äº’å¢å¼º

### 1. å¯¹è¯æµä¼˜åŒ–
```jsx
// æ·»åŠ æ‰“å­—æœºæ•ˆæœ
const TypewriterEffect = ({ text }) => {
  const [displayText, setDisplayText] = useState('');
  // é€å­—æ˜¾ç¤ºåŠ¨ç”»
};

// æ·»åŠ è¯­éŸ³è¾“å…¥
const VoiceInput = () => {
  const recognition = new webkitSpeechRecognition();
  // è¯­éŸ³è¯†åˆ«
};
```

### 2. æ™ºèƒ½æ¨èå¡ç‰‡
```jsx
<RecommendationCard>
  <PriceComparison />  {/* ä»·æ ¼å¯¹æ¯” */}
  <SubsidyBreakdown />  {/* è¡¥è´´è¯¦æƒ… */}
  <PlatformLinks />  {/* ç”µå•†é“¾æ¥ */}
  <UserReviews />  {/* ç”¨æˆ·è¯„ä»· */}
</RecommendationCard>
```

### 3. äº¤äº’å¼å›¾è¡¨
```jsx
import { Chart } from 'react-chartjs-2';

<Chart 
  type="bar"
  data={subsidyData}
  options={{
    onClick: (e, item) => {
      // ç‚¹å‡»æŸ±çŠ¶å›¾æŸ¥çœ‹è¯¦æƒ…
    }
  }}
/>
```

---

## ğŸ§  å››ã€AIèƒ½åŠ›æå‡

### 1. å¤šAgentåä½œå¢å¼º
```python
# åœ¨ multi_agent.py ä¸­å¢åŠ ä¸“å®¶Agent
class ExpertAgents:
    def __init__(self):
        self.price_expert = PriceExpertAgent()  # ä»·æ ¼ä¸“å®¶
        self.policy_expert = PolicyExpertAgent()  # æ”¿ç­–ä¸“å®¶
        self.user_profiler = UserProfilerAgent()  # ç”¨æˆ·ç”»åƒ
    
    async def collaborate(self, query):
        """å¤šä¸“å®¶ååŒå†³ç­–"""
        results = await asyncio.gather(
            self.price_expert.analyze(query),
            self.policy_expert.analyze(query),
            self.user_profiler.analyze(query)
        )
        return self._merge_results(results)
```

### 2. ä¸»åŠ¨å­¦ä¹ 
```python
class FeedbackLearner:
    def collect_feedback(self, query, answer, rating):
        """æ”¶é›†ç”¨æˆ·åé¦ˆ"""
        self.feedback_db.insert({
            "query": query,
            "answer": answer,
            "rating": rating,
            "timestamp": datetime.now()
        })
    
    def retrain_model(self):
        """åŸºäºåé¦ˆå¾®è°ƒæ¨¡å‹"""
        # ä½¿ç”¨LoRAå¾®è°ƒ
        pass
```

### 3. çŸ¥è¯†å›¾è°±
```python
# æ„å»ºæ”¿ç­–çŸ¥è¯†å›¾è°±
class PolicyKnowledgeGraph:
    def build_graph(self):
        """æ„å»ºä¸‰å…ƒç»„: (å®ä½“, å…³ç³», å®ä½“)"""
        # (æµå—å¸‚, å‘å¸ƒ, æ±½è½¦è¡¥è´´æ”¿ç­–)
        # (æ±½è½¦è¡¥è´´æ”¿ç­–, è¡¥è´´é‡‘é¢, 3000å…ƒ)
        pass
    
    def query_graph(self, question):
        """é€šè¿‡å›¾è°±æ¨ç†ç­”æ¡ˆ"""
        pass
```

---

## ğŸ“ˆ äº”ã€æ€§èƒ½ä¼˜åŒ–

### 1. ç¼“å­˜ç­–ç•¥
```python
from functools import lru_cache
import redis

class CacheManager:
    def __init__(self):
        self.redis_client = redis.Redis()
    
    @lru_cache(maxsize=1000)
    def get_cached_answer(self, query_hash):
        """ç¼“å­˜å¸¸è§é—®é¢˜ç­”æ¡ˆ"""
        return self.redis_client.get(f"qa:{query_hash}")
```

### 2. å¼‚æ­¥å¤„ç†
```python
# å°†è€—æ—¶æ“ä½œå¼‚æ­¥åŒ–
async def async_recommend(budget, needs):
    """å¼‚æ­¥æ¨è"""
    loop = asyncio.get_event_loop()
    result = await loop.run_in_executor(
        None, 
        recommend_max_subsidy_plan, 
        budget, 
        needs
    )
    return result
```

### 3. æµå¼è¾“å‡º
```python
# åœ¨ app.py ä¸­å¢åŠ SSEç«¯ç‚¹
from fastapi.responses import StreamingResponse

@api_router.get("/stream_query")
async def stream_query(question: str):
    async def generate():
        async for chunk in agent.stream_answer(question):
            yield f"data: {chunk}\n\n"
    
    return StreamingResponse(generate(), media_type="text/event-stream")
```

---

## ğŸ” å…­ã€å®‰å…¨ä¸åˆè§„

### 1. æ•æ„Ÿä¿¡æ¯è„±æ•
```python
import re

def mask_personal_info(text):
    """è„±æ•æ‰‹æœºå·ã€èº«ä»½è¯"""
    text = re.sub(r'(\d{3})\d{4}(\d{4})', r'\1****\2', text)
    return text
```

### 2. å†…å®¹å®¡æ ¸
```python
class ContentModerator:
    def check_sensitive_words(self, text):
        """æ£€æŸ¥æ•æ„Ÿè¯"""
        blacklist = ["è¿æ³•", "ä½œå¼Š", "æ¼æ´"]
        for word in blacklist:
            if word in text:
                return False
        return True
```

### 3. è®¿é—®é™æµ
```python
from slowapi import Limiter
from slowapi.util import get_remote_address

limiter = Limiter(key_func=get_remote_address)

@app.post("/query")
@limiter.limit("10/minute")
async def query(request: Request):
    pass
```

---

## ğŸ“± ä¸ƒã€ç§»åŠ¨ç«¯é€‚é…

### 1. PWAæ”¯æŒ
```javascript
// åœ¨ intelli-policy ä¸­æ·»åŠ  service worker
// public/sw.js
self.addEventListener('fetch', (event) => {
  event.respondWith(
    caches.match(event.request).then((response) => {
      return response || fetch(event.request);
    })
  );
});
```

### 2. å“åº”å¼UIä¼˜åŒ–
```jsx
// ä½¿ç”¨ Tailwind å“åº”å¼æ–­ç‚¹
<div className="
  grid 
  grid-cols-1 
  md:grid-cols-2 
  lg:grid-cols-3
">
  {/* å¡ç‰‡åˆ—è¡¨ */}
</div>
```

---

## ğŸŒ å…«ã€å¤šè¯­è¨€æ”¯æŒ

```python
# i18n.py
class I18N:
    def __init__(self, lang='zh-CN'):
        self.lang = lang
        self.translations = {
            'zh-CN': {
                'greeting': 'æ‚¨å¥½',
                'subsidy': 'è¡¥è´´'
            },
            'en-US': {
                'greeting': 'Hello',
                'subsidy': 'Subsidy'
            }
        }
    
    def t(self, key):
        return self.translations[self.lang].get(key, key)
```

---

## ğŸ“Š ä¹ã€æ•°æ®åˆ†æä»ªè¡¨æ¿

```python
# å¢åŠ ç®¡ç†åå°
@api_router.get("/admin/dashboard")
async def get_dashboard_data():
    return {
        "total_queries": 1520,
        "avg_response_time": 2.3,
        "user_satisfaction": 4.7,
        "top_queries": [
            {"query": "æ±½è½¦è¡¥è´´æ ‡å‡†", "count": 245}
        ],
        "subsidy_stats": {
            "total_amount": 5280000,
            "avg_per_user": 3470
        }
    }
```

---

## ğŸ¯ å®æ–½ä¼˜å…ˆçº§å»ºè®®

### ğŸ”¥ é«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³å®æ–½ï¼‰
1. âœ… **æ’ä»¶ç³»ç»Ÿ** - å·²åˆ›å»ºæ¡†æ¶
2. **æµå¼è¾“å‡º** - æå‡ç”¨æˆ·ä½“éªŒ
3. **ç¼“å­˜ä¼˜åŒ–** - é™ä½æˆæœ¬
4. **å›¾è¡¨å¯è§†åŒ–** - å¢å¼ºå±•ç¤º

### ğŸŒŸ ä¸­ä¼˜å…ˆçº§ï¼ˆ1-2å‘¨ï¼‰
1. **å¤šæ ¼å¼æŠ¥è¡¨** - PDF/Excelå¯¼å‡º
2. **ä»·æ ¼æ¯”è¾ƒæ’ä»¶** - å¯¹æ¥ç”µå•†API
3. **OCRè¯†åˆ«** - è‡ªåŠ¨è¯†åˆ«å°ç¥¨
4. **è¯­éŸ³äº¤äº’** - TTS/STT

### ğŸ’¡ ä½ä¼˜å…ˆçº§ï¼ˆé•¿æœŸè§„åˆ’ï¼‰
1. **çŸ¥è¯†å›¾è°±** - æ·±åº¦æ¨ç†
2. **ä¸»åŠ¨å­¦ä¹ ** - æ¨¡å‹å¾®è°ƒ
3. **ç§»åŠ¨ç«¯PWA** - ç¦»çº¿ä½¿ç”¨
4. **å¤šè¯­è¨€** - å›½é™…åŒ–

---

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### 1. å¯ç”¨æ’ä»¶ç³»ç»Ÿ
```python
# åœ¨ agent.py ä¸­é›†æˆ
from plugin_manager import PluginManager

class PolicyAgent:
    def __init__(self):
        self.plugin_manager = PluginManager()
        self.plugin_manager.load_all_plugins()
    
    def query_with_plugins(self, question):
        """ä½¿ç”¨æ’ä»¶å¢å¼ºæŸ¥è¯¢"""
        base_result = self.query(question)
        
        # å¦‚æœæ¶‰åŠä»·æ ¼ï¼Œè°ƒç”¨ä»·æ ¼æ¯”è¾ƒæ’ä»¶
        if "ä»·æ ¼" in question or "å¤šå°‘é’±" in question:
            price_data = self.plugin_manager.execute_plugin(
                "price_comparator",
                {"products": extracted_products}
            )
            base_result["price_comparison"] = price_data
        
        return base_result
```

### 2. æµ‹è¯•æ’ä»¶
```bash
cd e:\shensibeiai
python plugin_manager.py
```

---

## ğŸ“š å‚è€ƒèµ„æº

- **LangChainæ–‡æ¡£**: https://python.langchain.com
- **FastAPIæœ€ä½³å®è·µ**: https://fastapi.tiangolo.com
- **Reactå›¾è¡¨åº“**: https://recharts.org
- **OCRæœåŠ¡**: ç™¾åº¦OCR / è…¾è®¯OCR
- **TTSæœåŠ¡**: Azure TTS / é˜¿é‡Œäº‘è¯­éŸ³

---

**æŒç»­è¿­ä»£ï¼Œæ‹¥æŠ±å˜åŒ–ï¼** ğŸš€
