## 📋 完整测试步骤（简化版）

### 🚀 一键启动测试

```powershell
# 1. 启动服务器
cd e:\shensibeiai
python app.py

# 等待看到:
# ✓ 插件已加载: price_comparator v1.0.0
# ✓ 插件已加载: report_generator v1.0.0
# 智能体初始化完成！
```

---

### 📊 测试图表可视化（最直观）

1. **打开浏览器**
   ```
   http://localhost:8000
   ```

2. **点击"智能规划师"标签**（Calculator 图标）

3. **设置参数**
   - 预算滑块：拖到 `¥15,000`
   - 意向品类：可选可不选

4. **点击"生成最优方案"**

5. **查看结果** - 应该看到：

   **✅ 文字信息：**
   ```
   选中 6 件产品
   总补贴 ￥1,825
   实际净支出 ￥13,175
   资金利用率 100%
   ```

   **✅ 产品清单（6件）：**
   ```
   1. 手机 (¥4000) → 补贴¥500
   2. 手机 (¥2000) → 补贴¥300
   3. 平板 (¥2500) → 补贴¥300
   4. 平板 (¥1500) → 补贴¥225
   5. 洗衣机 (¥1500) → 补贴¥150
   6. 冰箱 (¥3500) → 补贴¥350
   ```

   **✅ 三张图表：**
   
   - **📊 价格对比柱状图**
     - 横轴：6个产品
     - 纵轴：金额（元）
     - 柱子：原价（灰）、实付（绿）、补贴（蓝）
   
   - **🥧 补贴占比饼图**
     - 彩色扇形
     - 每个产品占比不同
     - 手机¥500占比最大
   
   - **📈 资金利用率折线图**
     - 三个点：预算 → 实际花费 → 补贴后
     - 蓝色折线连接

6. **截图保存**
   - 这是最完整的功能展示

---

### ⚡ 测试流式输出

**方式1：浏览器访问**
```
http://localhost:8000/api/stream_query?question=济南市补贴标准
```

**预期效果：**
- 页面逐字显示内容
- 像"打字机"一样输出
- 不是一次性显示完整答案

**方式2：命令行测试**
```powershell
curl -N "http://localhost:8000/api/stream_query?question=测试流式输出"
```

**预期输出：**
```
data: {"type":"start","message":"开始处理问题..."}

data: {"type":"intent","message":"正在识别问题意图..."}

data: {"type":"chunk","content":"济南市"}

data: {"type":"chunk","content":"家电补"}

...
```

---

### 🔌 测试插件系统

**方式1：查看后端日志**

在生成推荐方案时，后端日志应显示：

```
[DEBUG Agent] 推荐结果: 6件产品, 总补贴￥1825
✓ 价格比较插件运行成功: 总节省￥300
```

**方式2：独立测试**
```powershell
cd e:\shensibeiai
python test_plugins.py
```

**预期输出：**
```
✓ 插件已加载: price_comparator v1.0.0
✓ 插件已加载: report_generator v1.0.0

价格对比:
  冰箱:
    京东: ¥2999
    淘宝: ¥2899
    最优平台: taobao (节省¥100)
```

---

### 🧪 验证完整数据流

**打开浏览器开发者工具（F12）：**

1. 切换到 **Network** 标签
2. 在前端生成推荐方案
3. 找到 `/api/query` 请求
4. 点击查看 **Response**

**应该看到完整 JSON：**
```json
{
  "question": "我有15000元预算...",
  "answer": "...专业推荐分析...",
  "confidence": 0.95,
  "recommendation": {
    "selected_products": [
      {"name": "手机", "price": 4000, "subsidy": 500},
      {"name": "手机", "price": 2000, "subsidy": 300},
      ...
    ],
    "total_subsidy": 1825,
    "final_cost": 13175,
    "utilization_rate": 1.0,
    "is_optimal": true
  },
  "price_comparison": {
    "status": "success",
    "comparisons": [...],
    "total_savings": 300
  },
  "algorithm": "dp",
  "is_optimal": true
}
```

---

### ✅ 测试检查清单

| 项目 | 测试方法 | 预期结果 | 状态 |
|------|---------|---------|------|
| 推荐算法 | 前端生成方案 | 返回6件产品 | ⬜ |
| 柱状图 | 查看图表 | 显示3种柱子 | ⬜ |
| 饼图 | 查看图表 | 显示彩色扇形 | ⬜ |
| 折线图 | 查看图表 | 显示蓝色折线 | ⬜ |
| 流式输出 | 浏览器访问 | 逐字显示 | ⬜ |
| 价格比较插件 | 后端日志 | 显示"运行成功" | ⬜ |
| 完整数据 | F12 Network | JSON 包含所有字段 | ⬜ |

---

### 🎯 推荐测试顺序

1. **先测前端图表**（最直观）
2. **再测流式输出**（打开新标签页访问 URL）
3. **最后验证插件**（查看后端日志或运行测试脚本）

---

### 📸 建议截图

完成测试后截图保存：

1. 前端完整界面（显示3张图表）
2. 产品清单详情
3. 后端日志（显示插件加载）
4. 流式输出过程

---

### ❓ 遇到问题？

#### 问题1：前端没显示图表
```powershell
# 重新构建前端
cd e:\shensibeiai\intelli-policy
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
npm run build

# 重启后端
cd e:\shensibeiai
python app.py
```

#### 问题2：推荐方案为空
- 确认预算 ≥ ¥1500
- 查看后端日志确认参数提取正确

#### 问题3：流式输出无反应
- 确认使用了 `-N` 参数（curl）
- 或直接在浏览器访问

---

**详细测试文档**：[`测试新功能完整指南.md`](file:///e:/shensibeiai/测试新功能完整指南.md)

祝测试顺利！🚀
